
<form id="contact" method="POST"
action="https://script.google.com/macros/s/AKfycbyXAk3A6KaPeTVah-KWpRNizjEsZ-z2uYmJloMFpLj5Y6rAFeujQhqpmu3KtP2N0367/exec">
<div class="row">
  <div class="col-lg-12"></div>
  <div class="col-lg-5">
    <div id="map">
      <iframe
        src="https://www.google.com/maps/embed?pb=!1m17!1m12!1m3!1d3784.023184716494!2d73.80712281489218!3d18.482608987431163!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m2!1m1!2zMTjCsDI4JzU3LjQiTiA3M8KwNDgnMzMuNSJF!5e0!3m2!1sen!2sin!4v1685898423654!5m2!1sen!2sin"
        width="100%" height="480px" style="border:0; padding: 10px;" allowfullscreen="" loading="lazy"
        referrerpolicy="no-referrer-when-downgrade"></iframe>
    </div>
  </div>
  <div class="col-lg-7">
    <div class="fill-form">
      <div class="row">
        <div class="col-lg-6">
          <fieldset>
            <input type="text" name="name" id="name" placeholder="Name" autocomplete="on" required>
          </fieldset>
          <fieldset>
            <input type="email" name="email" id="email" pattern="[^ @]*@[^ @]*" placeholder="Your Email"
              required="">
          </fieldset>
          <fieldset>
            <input type="text" name="subject" id="subject" placeholder="Subject" autocomplete="on">
          </fieldset>
        </div>
        <div class="col-lg-6">
          <fieldset>
            <textarea name="message" class="form-control" id="message" placeholder="Message"
              required=""></textarea>
          </fieldset>
        </div>
        <div class="col-lg-12">
          <fieldset>
            <button type="submit" id="form-submit" class="main-button">Send Message Now</button>
          </fieldset>
        </div>
      </div>
    </div>
  </div>
</div>
</form>

<script>
document.getElementById("contact").addEventListener("submit", function(event) {
  event.preventDefault(); // Prevent the default form submission

  // Get form values
  var name = document.getElementById("name").value;
  var email = document.getElementById("email").value;
  var subject = document.getElementById("subject").value;
  var message = document.getElementById("message").value;

  // Construct the URL for the server-side script
  var url = "https://script.google.com/macros/s/AKfycbyXAk3A6KaPeTVah-KWpRNizjEsZ-z2uYmJloMFpLj5Y6rAFeujQhqpmu3KtP2N0367/exec";

  // Create a new FormData object and populate it with form data
  var formData = new FormData();
  formData.append("name", name);
  formData.append("email", email);
  formData.append("subject", subject);
  formData.append("message", message);

  // Create a new XMLHttpRequest object
  var xhr = new XMLHttpRequest();
  xhr.open("POST", url, true);

  // Set the onload callback function
  xhr.onload = function() {
    if (xhr.status === 200) {
      alert("Message sent successfully!");

      // Reset the form fields
      document.getElementById("name").value = "";
      document.getElementById("email").value = "";
      document.getElementById("subject").value = "";
      document.getElementById("message").value = "";
    } else {
      alert("An error occurred while sending the message. Please try again.");
    }
  };

  // Send the form data
  xhr.send(formData);
});

</script>




<!-- Apppps Script -->
function sendEmail(name, email, subject, message) {
  var recipientEmail = 'oddcreatives15@gmail.com'; // Replace with your email address

  var body = "Name: " + name + "\n\n";
  body += "Email: " + email + "\n\n";
  body += "Subject: " + subject + "\n\n";
  body += "Message: " + message;

  var subjectLine = "New contact form submission";

  MailApp.sendEmail({
    to: recipientEmail,
    subject: subjectLine,
    body: body
  });
}
